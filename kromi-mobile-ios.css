/**
 * ==========================================
 * KROMI MOBILE IOS - iOS-Specific Adjustments
 * ==========================================
 * 
 * Special handling for iOS Safari and PWA
 * Targets class: os-ios
 * 
 * Features:
 * - Safe area insets for notches
 * - iOS Safari fullscreen quirks
 * - Standalone PWA mode
 * - iOS-specific touch handling
 * 
 * Vers√£o: 2.0
 * ==========================================
 */

/* ==========================================
   iOS: SAFE AREA INSETS
   ========================================== */

.os-ios .camera-container {
    /* Respect notches on iPhone X+ */
    padding-top: env(safe-area-inset-top);
    padding-bottom: env(safe-area-inset-bottom);
    padding-left: env(safe-area-inset-left);
    padding-right: env(safe-area-inset-right);
}

.os-ios .back-button-mobile {
    /* Position with safe area */
    top: calc(env(safe-area-inset-top, 8px) + var(--spacing-2));
    left: calc(env(safe-area-inset-left, 0px) + var(--spacing-2));
}

.os-ios .camera-info {
    top: calc(env(safe-area-inset-top, 0px) + var(--spacing-4));
    left: calc(env(safe-area-inset-left, 0px) + var(--spacing-4));
    right: calc(env(safe-area-inset-right, 0px) + var(--spacing-4));
}

.os-ios .main-camera-controls {
    bottom: calc(env(safe-area-inset-bottom, 0px) + var(--spacing-4));
}

.os-ios .side-controls {
    left: calc(env(safe-area-inset-left, 0px) + var(--spacing-2));
}

/* ==========================================
   iOS: STANDALONE PWA MODE
   ========================================== */

.os-ios.standalone .camera-container {
    /* iOS PWA uses full screen minus safe areas */
    height: 100vh;
    height: 100dvh;
}

.os-ios.standalone .layout-with-sidebar .main {
    /* No browser UI in standalone */
    height: 100vh;
    height: 100dvh;
}

/* iOS Safari address bar handling */
@supports (-webkit-touch-callout: none) {
    .os-ios .camera-container {
        /* Use dvh for dynamic viewport on iOS */
        height: 100dvh;
        min-height: -webkit-fill-available;
    }
}

/* ==========================================
   iOS: TOUCH HANDLING
   ========================================== */

.os-ios button,
.os-ios .btn,
.os-ios input {
    /* Prevent iOS zoom on focus */
    font-size: 16px;
}

.os-ios .form-input {
    /* Prevent zoom in inputs (must be at least 16px) */
    font-size: 16px;
    transform: scale(1);
}

/* iOS-specific touch targets */
.os-ios .btn {
    -webkit-tap-highlight-color: rgba(252, 107, 3, 0.3);
    touch-action: manipulation;
}

/* ==========================================
   iOS: NOTCH COMPENSATION
   ========================================== */

/* Portrait with notch (iPhone X, 11, 12, 13, 14, 15) */
.os-ios.ar-tall:not(.landscape) .camera-container {
    padding-top: env(safe-area-inset-top, 20px);
}

/* Landscape with notch */
.os-ios.landscape.ar-tall .camera-container {
    padding-left: env(safe-area-inset-left, 0px);
    padding-right: env(safe-area-inset-right, 0px);
}

/* ==========================================
   iOS: SYSTEM BARS
   ========================================== */

.os-ios .app-bottom-nav {
    /* iOS doesn't need bottom nav compensation */
    padding-bottom: calc(env(safe-area-inset-bottom, 0px));
}

/* ==========================================
   iOS: FULLSCREEN QUIRKS
   ========================================== */

.os-ios .camera-video {
    /* Prevent iOS Safari from showing fullscreen controls */
    -webkit-playsinline: true;
    playsinline: true;
}

/* iOS fullscreen API support */
.os-ios:fullscreen .camera-container {
    height: 100vh;
}

.os-ios:-webkit-full-screen .camera-container {
    height: 100vh;
}

/* ==========================================
   iOS: ADDRESS BAR COMPENSATION
   ========================================== */

/* Handle iOS Safari address bar appearing/disappearing */
.os-ios .layout-with-sidebar {
    /* Use fixed positioning to avoid layout shift */
    position: fixed;
    width: 100%;
    height: 100%;
}

/* ==========================================
   iOS: TEXT SIZE ADJUSTMENTS
   ========================================== */

.os-ios h1,
.os-ios h2,
.os-ios h3 {
    -webkit-text-size-adjust: 100%;
}

/* Prevent iOS font boosting */
.os-ios body {
    -webkit-text-size-adjust: 100%;
    text-size-adjust: 100%;
}

/* ==========================================
   iOS: STATUS BAR STYLE
   ========================================== */

/* This is handled by meta tags in HTML */
/* apple-mobile-web-app-status-bar-style: black-translucent */

/* ==========================================
   iOS: KEYBOARD AVOIDANCE
   ========================================== */

.os-ios .permission-content {
    /* Prevent layout shift when keyboard appears */
    position: relative;
    max-height: 90vh;
    overflow-y: auto;
}

.os-ios .pin-entry-panel {
    /* Ensure keyboard doesn't cover input */
    padding-bottom: env(keyboard-inset-height, 0px);
}

/* ==========================================
   iOS: SCROLLING BEHAVIOR
   ========================================== */

.os-ios body {
    /* Smooth scrolling on iOS */
    -webkit-overflow-scrolling: touch;
}

.os-ios .camera-overlay {
    /* Prevent scrolling in camera view */
    overscroll-behavior: none;
    -webkit-overflow-scrolling: touch;
}

/* ==========================================
   iOS: BLUR PERFORMANCE
   ========================================== */

.os-ios .detection-stats,
.os-ios .event-info,
.os-ios .back-button-mobile {
    /* Optimize backdrop-filter for iOS */
    backdrop-filter: blur(10px);
    -webkit-backdrop-filter: blur(10px);
}

/* Reduce effects on older devices */
.os-ios.reduced-effects .detection-stats,
.os-ios.reduced-effects .event-info {
    backdrop-filter: none;
    -webkit-backdrop-filter: none;
    background: rgba(0, 0, 0, 0.95);
}

/* ==========================================
   iOS: HAPTIC FEEDBACK (Future Enhancement)
   ========================================== */

/* Note: This would require JavaScript implementation */
.os-ios .btn:active {
    /* Visual feedback for haptics */
    transform: scale(0.95);
    transition: transform 0.1s ease;
}

/* ==========================================
   iOS: DARK MODE SUPPORT
   ========================================== */

@media (prefers-color-scheme: dark) {
    .os-ios .permission-panel {
        background: rgba(0, 0, 0, 0.95);
    }
    
    .os-ios .permission-content {
        background: var(--bg-secondary);
        color: var(--text-primary);
    }
}

/* ==========================================
   iOS: ORIENTATION LOCK WARNING
   ========================================== */

/* Use JavaScript to detect and warn about orientation changes */

/* ==========================================
   iOS: APP ICON AND SPLASH (Handled by manifest.json)
   ========================================== */

/* apple-touch-icon and splash screen are configured in manifest.json */

/* ==========================================
   iOS: INPUT FIXES
   ========================================== */

.os-ios input[type="password"] {
    /* Prevent auto-fill styling issues */
    -webkit-appearance: none;
    appearance: none;
}

.os-ios input[inputmode="numeric"] {
    /* Show numeric keypad */
    font-size: 16px; /* Prevent zoom */
}

/* ==========================================
   iOS: FOCUS RINGS
   ========================================== */

.os-ios .btn:focus-visible {
    /* iOS doesn't show focus rings by default */
    outline: 2px solid var(--primary);
    outline-offset: 2px;
}

/* ==========================================
   iOS: SWIPE GESTURES
   ========================================== */

.os-ios .camera-overlay {
    /* Prevent iOS Safari swipe gestures */
    touch-action: none;
}

.os-ios .side-controls,
.os-ios .main-camera-controls {
    /* Allow touch events on controls */
    touch-action: manipulation;
}

