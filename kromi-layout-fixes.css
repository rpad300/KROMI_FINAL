/**
 * ==========================================
 * KROMI LAYOUT FIXES - Correções de Layout
 * ==========================================
 * 
 * Correções específicas para problemas de layout
 * entre header e sidebar em páginas KROMI
 * 
 * Versão: 1.0
 * Data: 2025-01-24
 * ==========================================
 */

/* ==========================================
   CORREÇÕES DE LAYOUT COM SIDEBAR
   ========================================== */

/* Garantir que o header não sobreponha o sidebar - PRIORIDADE MÁXIMA */
.layout-with-sidebar .header {
    position: fixed !important;
    top: 0 !important;
    left: 280px !important;
    right: 0 !important;
    height: 60px !important;
    background: var(--bg-primary) !important;
    border-bottom: 1px solid var(--border-color) !important;
    z-index: 1040 !important;
    display: flex !important;
    align-items: center !important;
    justify-content: space-between !important;
    padding: 0 var(--spacing-5) !important;
    transition: left var(--transition-slow) !important;
}

/* Garantir que o sidebar tenha z-index correto - PRIORIDADE MÁXIMA */
.layout-with-sidebar .sidebar {
    position: fixed !important;
    left: 0 !important;
    top: 0 !important;
    width: 280px !important;
    height: 100vh !important;
    background: var(--bg-secondary) !important;
    border-right: 1px solid var(--border-color) !important;
    z-index: 1050 !important;
    overflow-y: auto !important;
    transition: transform var(--transition-slow) !important;
}

/* Garantir que o main content tenha margem correta - PRIORIDADE MÁXIMA */
.layout-with-sidebar .main {
    margin-left: 280px !important;
    margin-top: 60px !important;
    width: calc(100% - 280px) !important;
    min-height: calc(100vh - 60px) !important;
    transition: margin-left var(--transition-slow), width var(--transition-slow) !important;
}

/* ==========================================
   FUNCIONALIDADE DE TOGGLE DO SIDEBAR
   ========================================== */

/* Sidebar oculto */
.layout-with-sidebar .sidebar-hidden {
    transform: translateX(-100%) !important;
}

/* Main expandido quando sidebar está oculto - COBRE TODA A TELA */
.layout-with-sidebar .main-expanded {
    margin-left: 0 !important;
    width: 100% !important;
    max-width: 100vw !important;
}

/* Header expandido quando sidebar está oculto - COBRE TODA A TELA */
.layout-with-sidebar .header-expanded {
    left: 0 !important;
    width: 100% !important;
    max-width: 100vw !important;
    right: 0 !important;
}

/* GARANTIR QUE HEADER SE ADAPTE COMPLETAMENTE QUANDO SIDEBAR ESTÁ OCULTO */
.sidebar-hidden .header,
body.sidebar-hidden .header,
.layout-with-sidebar.sidebar-hidden .header {
    left: 0 !important;
    width: 100% !important;
    max-width: 100vw !important;
    right: 0 !important;
}

/* GARANTIR QUE HEADER SE ADAPTE COMPLETAMENTE QUANDO SIDEBAR ESTÁ OCULTO */
.layout-with-sidebar .main-expanded ~ .header,
.layout-with-sidebar .sidebar-hidden ~ .header {
    left: 0 !important;
    width: 100% !important;
    max-width: 100vw !important;
    right: 0 !important;
}

/* Botão de menu hambúrguer - SEMPRE VISÍVEL */
#menuToggle {
    display: flex !important;
}

/* GARANTIR QUE BOTÕES DO HEADER PERMANEÇAM VISÍVEIS */
#headerActions,
.header #headerActions,
.layout-with-sidebar .header #headerActions {
    display: flex !important;
    visibility: visible !important;
    opacity: 1 !important;
}

/* GARANTIR QUE BOTÕES DO HEADER PERMANEÇAM VISÍVEIS QUANDO SIDEBAR ESTÁ OCULTO */
.sidebar-hidden #headerActions,
.sidebar-hidden .header #headerActions,
body.sidebar-hidden #headerActions,
body.sidebar-hidden .header #headerActions,
.layout-with-sidebar.sidebar-hidden #headerActions,
.layout-with-sidebar.sidebar-hidden .header #headerActions {
    display: flex !important;
    visibility: visible !important;
    opacity: 1 !important;
}

/* Garantir que quando sidebar está oculto, não há espaços em branco */
.layout-with-sidebar.sidebar-hidden .main,
.layout-with-sidebar.sidebar-hidden .header {
    margin-left: 0 !important;
    width: 100% !important;
    max-width: 100vw !important;
}

/* CORREÇÃO ESPECÍFICA PARA QUANDO SIDEBAR ESTÁ OCULTO */
.layout-with-sidebar .sidebar-hidden ~ .main,
.layout-with-sidebar .sidebar-hidden ~ .header {
    margin-left: 0 !important;
    width: 100% !important;
    max-width: 100vw !important;
}

/* CORREÇÃO ESPECÍFICA PARA QUANDO SIDEBAR ESTÁ OCULTO */
body.sidebar-hidden .layout-with-sidebar .main,
body.sidebar-hidden .layout-with-sidebar .header {
    margin-left: 0 !important;
    width: 100% !important;
    max-width: 100vw !important;
}

/* CORREÇÃO ESPECÍFICA PARA QUANDO SIDEBAR ESTÁ OCULTO */
.sidebar-hidden .main,
.sidebar-hidden .header {
    margin-left: 0 !important;
    width: 100% !important;
    max-width: 100vw !important;
}

/* Garantir que o conteúdo principal ocupe toda a largura disponível */
.layout-with-sidebar .main-expanded .container,
.layout-with-sidebar .main-expanded .content,
.layout-with-sidebar .main-expanded .page-content {
    width: 100% !important;
    max-width: none !important;
    margin: 0 !important;
    padding-left: var(--spacing-4) !important;
    padding-right: var(--spacing-4) !important;
}

/* Garantir que quando sidebar está oculto, body também seja afetado */
body.sidebar-hidden .main,
body.sidebar-hidden .header {
    margin-left: 0 !important;
    width: 100% !important;
    max-width: 100vw !important;
}

/* Garantir que quando sidebar está oculto, não há espaços em branco */
.sidebar-hidden .main,
.sidebar-hidden .header {
    margin-left: 0 !important;
    width: 100% !important;
    max-width: 100vw !important;
}

/* Garantir que grids e layouts se adaptem quando sidebar está oculto */
.layout-with-sidebar .main-expanded .events-grid,
.layout-with-sidebar .main-expanded .classifications-grid,
.layout-with-sidebar .main-expanded .participants-grid,
.layout-with-sidebar .main-expanded .devices-grid {
    width: 100% !important;
    max-width: none !important;
    grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)) !important;
}

/* ==========================================
   CORREÇÕES PARA MOBILE
   ========================================== */

@media (max-width: 1024px) {
    /* Garantir que o body não tenha overflow horizontal */
    body {
        overflow-x: hidden !important;
    }
    
    /* Sidebar escondido por padrão em mobile */
    .layout-with-sidebar .sidebar {
        transform: translateX(-100%) !important;
    }
    
    /* Sidebar aberto quando tem classe sidebar-open */
    .layout-with-sidebar .sidebar.sidebar-open {
        transform: translateX(0) !important;
    }
    
    /* Header ocupa toda a largura em mobile */
    .layout-with-sidebar .header {
        left: 0 !important;
    }
    
    /* Main content ocupa toda a largura em mobile */
    .layout-with-sidebar .main {
        margin-left: 0 !important;
        margin-top: 60px !important;
        width: 100% !important;
        min-height: calc(100vh - 60px) !important;
        padding-bottom: 80px !important;
    }
    
    /* Garantir que o conteúdo principal tenha altura correta */
    #mainContent {
        min-height: calc(100vh - 60px - 80px) !important;
        padding: var(--spacing-4) !important;
    }
    
    /* Mostrar botão de toggle do menu */
    #menuToggle {
        display: block !important;
    }
    
    /* Mostrar navegação inferior */
    .app-bottom-nav {
        display: flex !important;
    }
}

/* ==========================================
   CORREÇÕES ESPECÍFICAS PARA Z-INDEX
   ========================================== */

/* Garantir hierarquia correta de z-index */
.layout-with-sidebar .sidebar {
    z-index: 1050 !important;
}

.layout-with-sidebar .header {
    z-index: 1040 !important;
}

.layout-with-sidebar .main {
    z-index: 1 !important;
}

/* ==========================================
   CORREÇÕES PARA NAVEGAÇÃO
   ========================================== */

/* Garantir que os elementos de navegação funcionem corretamente */
.nav-menu {
    padding: var(--spacing-4) !important;
}

.nav-category {
    font-size: var(--font-size-sm) !important;
    font-weight: 600 !important;
    color: var(--text-secondary) !important;
    margin-bottom: var(--spacing-3) !important;
    text-transform: uppercase !important;
    letter-spacing: 0.5px !important;
}

.nav-separator {
    height: 1px !important;
    background: var(--border-color) !important;
    margin: var(--spacing-4) 0 !important;
}

/* Estilos para nav-item */
.nav-item {
    display: flex !important;
    align-items: center !important;
    gap: var(--spacing-3) !important;
    padding: var(--spacing-3) !important;
    border-radius: var(--radius-md) !important;
    text-decoration: none !important;
    color: var(--text-secondary) !important;
    transition: all var(--transition-fast) !important;
    margin-bottom: var(--spacing-1) !important;
}

.nav-item:hover {
    background: var(--bg-primary) !important;
    color: var(--text-primary) !important;
}

.nav-item.active {
    background: var(--primary) !important;
    color: white !important;
}

.nav-item .icon {
    font-size: var(--font-size-lg) !important;
}

.nav-item .text {
    font-size: var(--font-size-sm) !important;
    font-weight: 500 !important;
}

/* ==========================================
   CORREÇÕES PARA BOTÕES DE HEADER
   ========================================== */

/* Garantir que os botões do header tenham estilo correto */
.layout-with-sidebar .header .btn {
    display: inline-flex !important;
    align-items: center !important;
    gap: var(--spacing-2) !important;
    padding: var(--spacing-2) var(--spacing-3) !important;
    border-radius: var(--radius-base) !important;
    font-size: var(--font-size-sm) !important;
    font-weight: 500 !important;
    text-decoration: none !important;
    border: 1px solid transparent !important;
    cursor: pointer !important;
    transition: all var(--transition-fast) !important;
}

.layout-with-sidebar .header .btn-icon {
    padding: var(--spacing-2) !important;
    width: auto !important;
    height: auto !important;
}

.layout-with-sidebar .header .btn-sm {
    padding: var(--spacing-1) var(--spacing-2) !important;
    font-size: var(--font-size-xs) !important;
}

/* ==========================================
   CORREÇÕES PARA RESPONSIVIDADE
   ========================================== */

/* Garantir que em telas muito pequenas tudo funcione */
@media (max-width: 480px) {
    .layout-with-sidebar .header {
        padding: 0 var(--spacing-3) !important;
    }
    
    .layout-with-sidebar .header h2 {
        font-size: var(--font-size-lg) !important;
    }
    
    .layout-with-sidebar .main {
        padding: var(--spacing-3) !important;
    }
}

/* ==========================================
   CORREÇÕES ESPECÍFICAS PARA PÁGINAS
   ========================================== */

/* Garantir que páginas específicas não quebrem o layout */
.layout-with-sidebar .sidebar,
.layout-with-sidebar .header {
    display: block !important;
}

/* Garantir que o main content não seja afetado por estilos específicos */
.layout-with-sidebar .main {
    position: relative !important;
    overflow-y: auto !important;
}

/* ==========================================
   CORREÇÕES PARA ESTILOS INLINE CONFLITANTES
   ========================================== */

/* Sobrescrever qualquer estilo inline que possa causar conflitos */
body .layout-with-sidebar .header {
    position: fixed !important;
    top: 0 !important;
    left: 280px !important;
    right: 0 !important;
    height: 60px !important;
    background: var(--bg-primary) !important;
    border-bottom: 1px solid var(--border-color) !important;
    z-index: 1040 !important;
    display: flex !important;
    align-items: center !important;
    justify-content: space-between !important;
    padding: 0 var(--spacing-5) !important;
    transition: left var(--transition-slow) !important;
}

body .layout-with-sidebar .sidebar {
    position: fixed !important;
    left: 0 !important;
    top: 0 !important;
    width: 280px !important;
    height: 100vh !important;
    background: var(--bg-secondary) !important;
    border-right: 1px solid var(--border-color) !important;
    z-index: 1050 !important;
    overflow-y: auto !important;
    transition: transform var(--transition-slow) !important;
}

body .layout-with-sidebar .main {
    margin-left: 280px !important;
    margin-top: 60px !important;
    width: calc(100% - 280px) !important;
    min-height: calc(100vh - 60px) !important;
    transition: margin-left var(--transition-slow), width var(--transition-slow) !important;
}

/* Garantir que elementos específicos não quebrem o layout */
.layout-with-sidebar .camera-container,
.layout-with-sidebar .fullscreen-mode {
    margin-left: 0 !important;
    margin-top: 0 !important;
    width: 100% !important;
    height: 100vh !important;
    position: fixed !important;
    top: 0 !important;
    left: 0 !important;
    z-index: 1060 !important;
}

/* Garantir que em modo fullscreen, sidebar e header sejam escondidos */
.layout-with-sidebar.fullscreen .sidebar,
.layout-with-sidebar.fullscreen .header {
    display: none !important;
}

.layout-with-sidebar.fullscreen .main {
    margin: 0 !important;
    width: 100% !important;
    height: 100vh !important;
    position: fixed !important;
    top: 0 !important;
    left: 0 !important;
}
